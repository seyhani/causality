% Todo: find proper signs for Es
Let $\mathrm{E} = (E,\#,\vdash,l,L)$ be an event structure with
$E = \s{e_1, e_2, ...,e_n}$ and let $\s{s_1,s_2,...,s_p}$ be the power set of $E$ where $p = 2^n$.
Given an event structure $\mathrm{E}$, we define
$\mathfrak{M}(\mathrm{E}) = (\mathcal{S},\mathcal{F},\mathcal{E})$
to be its causal model where 
$\mathcal{S} = (\mathcal{U},\mathcal{V},\mathcal{R})$, and all variables in
$\mathcal{U} \cup \mathcal{V}$ are boolean.
We define $\mathcal{U}$ to be empty and $\mathcal{V}$ as follows:
\begin{align*}
    \mathcal{V} = & \s{C_{i,j} | \forall 1 \leq i < j \leq n. e_i \in \mathcal{E} \amp e_j \in \mathcal{E}}                    \\
                  & \cup \s{EN_{k,i} | \forall 1 \leq k \leq p , \forall 1 \leq i \leq n . s_k \in P \amp e_i \in \mathcal{E} } \\
                  & \cup \s{M_{k,i} | \forall 1 \leq k \leq p , \forall 1 \leq i \leq n . s_k \in P \amp e_i \in \mathcal{E} } \\
\end{align*}
% We define $\mathcal{E}$ to be the set of all settings
% $(x_1,x_2,...,x_{|\mathcal{V}|})$ of the endogenous variables satisfying
% the following conditions:
% \begin{align*}
%      & \forall_{k,i}.
%     \left(
%     M_{k,i} \Rightarrow EN_{k,i}
%     \right)
%     \wedge
%     \left(
%     EN_{k,i} \Rightarrow Con(k)
%     \right)
%     \\
%      & \wedge \left(EN_{k,i} \Rightarrow
%     \forall k'. (s_k \subset s_{k'} \wedge Con(k')) \Rightarrow EN_{k',i}
%     \right)                             \\
%      & \wedge \left(
%     M_{k,i} \Rightarrow \forall k'.
%     (s_{k'} \subset s_k) \Rightarrow \neg M_{k',i}
%     \right)
% \end{align*}
For $x,y \in \mathcal{P}(\mathcal{E})$ we say $y$ is covered by $x$ written $ x \prec y$ iff:
\begin{align*}
    x \subseteq y \amp x \neq y \amp
    (\forall z. x \subseteq z \subseteq y \Rightarrow x = z
    \text{ or } y = z)
\end{align*}
For each variable $x \in \mathcal{V}$ we define $\vec V_x$ as a vector
of all variables in $\mathcal{V}$ excluding $x$.
Since $\mathcal{U} = \emptyset$ we omit $\vec u$ from the
signature of methods in $\mathcal{F}$.
We define the functions in $\mathcal{F}$ as follows:
\begin{align*}
    Con(k) & =   \left(
    \bigwedge_{\forall j,j'. j<j' \amp e_j,e_{j'} \in s_k}
    \neg C_{j,j'}
    \right)             \\
\end{align*}
$$
    F_{C_{i,j}}(\vec V_{C_{i,j}}) = \begin{cases}
        true  & \text{ if } e_i \# e_j \amp e_j \# e_i \\
        false & \text{ otherwise }
    \end{cases}
$$
$$
    F_{M_{k,i}}(\vec V_{M_{k,i}}) = \begin{cases}
        Con(k) & \text{ if } s_k \vdash_{min} e_i \\
        false  & \text{ otherwise }
    \end{cases}
$$
\begin{align*}
    \f{EN_{k,i}} & =
    \left(
    M_{k,i} \vee
    \left(
    \bigvee_{\forall l. s_l  \prec s_k}EN_{l,i}
    \right)
    \right)
    \bigwedge
    Con(k)
\end{align*}
We also define the following auxiliary functions:
\begin{align*}
    C(e,e') = C_{i,j}    & \iff e = e_i \wedge e' = e_j \\
    M(s,e)  = M_{k,i}    & \iff s = s_k \wedge e = e_i  \\
    EN(s,e)  = EN_{k,i}    & \iff s = s_k \wedge e = e_i  \\
    Con(e,e') = Con(i,j) & \iff e = e_i \wedge e' = e_j
\end{align*}
Let $\m = \mathfrak{M}(\mathrm{E})$.
Since we have defined $\mathcal{U}$ to be empty and 
\textcolor{red}{the model is recursive}, thus the values of variables in
$\mathcal{V}$ are uniquely defined.
Next, we define a reverse mapping from causal models to event structures.
Given a causal model $\m$ let $\vec v$ be the values of endogenous variables
in $\m$, i.e. $\m \vDash \vec V \la \vec v$ where $\vec V$ is the vector of
all endogenous variables.
We define $\mathfrak{E}(\vec v) = (\mathrm{E},\#',\vdash')$ where we have:
\begin{align*}
    e_i \#' e_j \iff C_{i,j} \\
    e_j \#'e_i \iff C_{i,j} \\
    s_k \vdash' e_i \iff E_{k,i}
\end{align*}
Using $\mathfrak{E}$, we define $\mathcal{E}$ to be the set of allowable
settings of the endogenous variables $\vec v$ for which
$\mathfrak{E}(\vec v)$ is an event structure.

Finally, for a given configuration $\sigma = \s{e_1,e_2,...,e_m}$ as a
counterexample we define the effect, or $\varphi$, for which we want to
ind the cause as a boolean variable which is true iff $\sigma \in \mathcal{F}(\mathfrak{E}(\vec v))$ where $\mathcal{F}$ is the set of the configurations of
a given event structure.
\pagebreak
\subsection{Examples}
\input{sections/examples}