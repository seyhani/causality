\subsubsection{Sum Causal Model}

Let $\mathrm{E} = (E,\#,\vdash)$ be an event structure where
$\mathrm{E} = \mathrm{E}_0 + \mathrm{E}_1$,
$\mathrm{E}_0 = (E_0,\#_0,\vdash_0)$ and
$\mathrm{E}_1 = (E_1,\#_1,\vdash_1)$.
We define injections $\iota_k(e) = (k,e)$, for $k=0,1$.
Given a set of events $X$ we define
$\iota_k(X) = \s{\iota_k(e)|e \in X}$.
Observe that $E = \iota_0(E_0) \cup \iota_1(E_1)$.

Let $\mathrm{E} = (E,\#,\vdash)$ be an event structure where
$E = \s{e_1, e_2, ...,e_n}$, we define the causal model
$\m = (\mathcal{S},\mathscr{F},\mathcal{E})$ of $\mathrm{E}$ where
$\mathcal{S} = (\mathcal{U},\mathcal{V},\mathcal{R})$.
We define $\mathcal{U}$ to be empty and $\mathcal{V}$ as follows:
\begin{align*}
    \mathcal{W} =
     & \s{C_{e_i,e_j} |  1 \leq i < j \leq n.
    e_i,e_j \in E }                             \\
     & \cup \s{EN_{s,e} | s \in \mathcal{P}(E),
    e \in E. e \not \in s }                     \\
     & \cup \s{M_{s,e} | s \in \mathcal{P}(E),
        e \in E. e \not \in s } \cup \s{PV}
\end{align*}

We define :
\begin{align*}
    \mathcal{V} = &
    \s{C_{e,e'} \in \mathcal{W}| e,e' \in \iota_0(E_0) \vee e,e' \in \iota_1(E_1)}              \\
                  & \s{EN_{s,e},M_{s,e} \in \mathcal{W}| s\cup\s{e} \subseteq \iota_0(E_0) \vee
    s \cup \s{e}  \subseteq \iota_1(E_1)
    }                                                                                           \\
    \mathcal{U} = & \mathcal{W} \setminus \mathcal{V}
\end{align*}
Let $\vec u$ be a vector of values of the variables in $\mathcal{U}$.
For a given variable $X$, let $\vec u(X)$ be the value of $X$ in $\vec u$.
For the given event structure $\mathrm{E}$ we define $\vec u$ such that we have:
\begin{align*}
    \vec u(C_{e,e'}) & = \T  \iff e\#e'      \\
    \vec u(M_{s,e})  & = \T   \iff \vdash e  \\
    \vec u(EN_{s,e}) & = \T  \iff s \vdash e
\end{align*}
For each variable $x \in \mathcal{V}$ we define $\vec V_x$ as a vector
of all variables in $\mathcal{V}$ excluding $x$.
For $x,y \in \mathcal{P}(E)$ we say $x$ is covered by $y$ written $ x \prec y$ iff:
\begin{align*}
    x \subseteq y \amp x \neq y \amp
    (\forall z. x \subseteq z \subseteq y \Rightarrow x = z
    \text{ or } y = z)
\end{align*}
We define the functions in $\mathscr{F}$ as follows:
$$
    \f{C_{e,e'}} = \begin{cases}
        true  & \text{ if } e \# e' \amp e' \# e \\
        false & \text{ otherwise }
    \end{cases}
$$
$$
    \f{M_{s,e}} = \begin{cases}
        Min(s,e) \wedge Con(s) & \text{ if } s \vdash_{min} e \\
        false                  & \text{ otherwise }
    \end{cases}
$$
\begin{align*}
    \f{EN_{s,e}} & =
    \left(
    M_{s,e} \vee
    \left(
    \bigvee_{s'\prec s}EN_{s',e}
    \right)
    \right)
    \bigwedge
    Con(s)
\end{align*}
Where we have:
\begin{align*}
    Con(s)   & =   \left(
    \bigwedge_{ 1\leq j<j' \leq n \wedge e_j,e_{j'} \in s}
    \neg C_{e_j,e_{j'}}
    \right)               \\
    Min(s,e) & = \left(
    \bigwedge_{s'. (s' \subset s \vee s \subset s')
        \wedge e \notin s'}
    \neg M(k',i)
    \right)
\end{align*}
Let $\mathbb{E}$ be the set of all event structures of the form
$(E,\#',\vdash',L,l)$ where $\#' \subseteq E \times E$
and $\vdash' \subseteq \mathcal{P}(E) \times E$.
We define a function
$ES: \times_{V \in \mathcal{V}\setminus \s{PV}} \mathcal{R}(V) \rightarrow \mathbb{E}$
which returns an event structure derived by values of variables
Let $\vec v$ be the vector of values of variables in
$\mathcal{V} \setminus \s{PV}$
we define $ES(\vec v) = (E,\#',\vdash', L,l)$ so that we have:
\begin{align*}
    \forall e,e' \in E. e \#' e' \wedge e' \#' e
     & \iff \vec{v}(C_{e,e'}) = \T \\
    \forall s \in \mathcal{P}(E), e \in E.  s \vdash' e
     & \iff \vec{v}(EN_{s,e}) = \T
\end{align*}
We define $F_{PV}$ such that it encodes the safety property violation
as a predicate on the set of configurations of $ES$.
We define $\mathcal{E}$ to be the set of all allowable
settings of the endogenous variables such as $\vec v'$
for which $ES(\vec v')$ is an event structure.

\subsubsection{Composing Sum}
Let $\mr{E} = (E,\#,\vdash)$ be an event structure where
$\mr{E} = \mr{E}_0 + \mathrm{E}_1$,
$\mr{E}_0 = (E_0,\#_0,\vdash_0)$ and
$\mr{E}_1 = (E_1,\#_1,\vdash_1)$.
We define injections $\iota_k(e) = (k,e)$, for $k=0,1$.
Given a set of events $X$ we define
$\iota_k(X) = \s{\iota_k(e)|e \in X}$.
Observe that $E = \iota_0(E_0) \cup \iota_1(E_1)$.
Let $C \subseteq E$, and $\mr{E}$ be an event structure on $E$, we say
$\mr{E} \vDash C$ iff $C \in \mathcal{F}(\mr{E})$.

Let $F(\vec X)$ be a function on the vector of variables $\vec X$.
We use $\iota(F(\vec X)) = F(\iota(\vec X))$.
We use $F$ to denote $F(\vec X)$ whenever it is obvious from the context.
Let $\m_0,\m_1,\m$ be causal models of $\mr{E}_0,\mr{E}_1,\mr{E}$ respectively.
Let $M_{s_0,e_0}$ be a variable in $m_0$.
Let $M_{s,e}$ be a variable in $m$ where $s = \iota_0(s_0)$ and $e = \iota_0(e_0)$.
We wish to prove that in the context $\vec u$,
$F_{M_{s,e}} = \iota_0(F_{M_{s_0,e_0}})$.
First, we know that:
\begin{align*}
    s_0 \vdash_0^{min} e_0 \iff \iota_0(s_0) \vdash^{min} \iota_0(e_0)
\end{align*}
Next we have
\begin{align*}
    F_{M_{s,e}} & =
    \left(
    \bigwedge_{ e',e'' \in s}
    \neg C_{e',e''}
    \right) \bigwedge
    \left(
    \bigwedge_{s'. (s' \subset s \vee s \subset s')
        \wedge e \notin s'}
    \neg M_{s',e}
    \right)
\end{align*}
Note that for each $s' \supseteq s$ if $s' \not \subseteq \iota_0(E_0)$ then
we have $M_{s',e} \in \mathcal{U}$ and regarding $\vec u$ its value is false.
Thus in the context $\mathcal{u}$ we can simplify $F_{M_{s,e}}$ as follows:
\begin{align*}
    F_{M_{s,e}} & =
    \left(
    \bigwedge_{ e',e'' \in s}
    \neg C_{e',e''}
    \right) \bigwedge
    \left(
    \bigwedge_{s'. (s' \subset s \vee s \subset s')
        \wedge e \notin s' \wedge s' \subseteq \iota_0(E_0)}
    \neg M_{s',e}
    \right)
\end{align*}
Thus we have :
\begin{align*}
    F_{M_{s,e}} = \iota_0(F_{M_{s_0,e_0}})
\end{align*}

$$
    F_{M_{s,e}} = \begin{cases}
        \left(
        \bigwedge_{ e',e'' \in s}
        \neg C_{e',e''}
        \right) \bigwedge
        \left(
        \bigwedge_{s'. (s' \subset s \vee s \subset s')
            \wedge e \notin s' \wedge s' \subseteq \iota_0(E_0)}
        \neg M_{s',e}
        \right)
        & \text{ if } s \cup \s{e} \subseteq \iota_0(E_0) 
        \wedge \iota_0^{-1}(s) \vdash^{min}_0 \iota_0^{-1}(e)
    \end{cases}
$$