\section{Causal Model of Unsafe Behavior in Event Structure}

\subsection{Causal Model of Event Structure}
Let $\mathrm{E} = (E,\#,\vdash)$ be an event structure where
$E = \s{e_1, e_2, ...,e_n}$.
Let $S \subseteq \mc{P}(E)$ be the set of unsafe behaviors.
We define the causal model
$\mc{M} = (\mc{S},\mc{F},\mc{E})$ of unsafe behavior
in $\mr{E}$ where
$\mathcal{S} = (\mathcal{U},\mathcal{V},\mathcal{R})$.
We define $\mathcal{U}$ to be empty and $\mathcal{V}$
consisting of boolean variables as follows:
\begin{align*}
    \mathcal{V} = & \s{C_{e_i,e_j} ~|~  1 \leq i < j \leq n.
    e_i \in E \wedge e_j \in E}                                \\
                  & \cup \s{EN_{s,e} ~|~ s \in \mathcal{P}(E),
    e \in E. e \not \in s }                                    \\
                  & \cup \s{M_{s,e} ~|~ s \in \mathcal{P}(E),
        e \in E. e \not \in s }
\end{align*}
Intuitively, these variables model the existence of specific elements in
each of the event structure relations: $\#$, $\vdash_{min}$, and $\vdash$.
For two events $e,e' \in E$, variables of the form $C_{e,e'}$ represent whether $e\#e'$.
Similarly, for a subset of events $s \subseteq E$ and an event $e \in E$,
we use variables of the form $M_{s,e}$ and $EN_{s,e}$ to represent
whether $s \vdash_{min} e$ and $s \vdash e$ respectively.
Finally, we use a single boolean variable, $PV$, which denote the
violation of property in the event structure.
For each variable $X \in \mathcal{V}$ we define $\vec V_X$
as a vector of all variables in $\mathcal{V} \setminus \s{X}$.
For $x,y \in \mathcal{P}(E)$ we say $x$ is covered by $y$ written $ x \prec y$ iff:
\begin{align*}
    x \subseteq y \wedge x \neq y \wedge
    (\forall z. x \subseteq z \subseteq y \Rightarrow x = z
    \vee y = z)
\end{align*}
We define the functions in $\mathcal{F}$ as follows:
$$
    \f{C_{e,e'}} = \begin{cases}
        true  & \text{ if } e \# e' \\
        false & \text{ otherwise }
    \end{cases}
$$
$$
    \f{M_{s,e}} = \begin{cases}
        Min(s,e) \wedge Con(s) & \text{ if } s \vdash_{min} e \\
        false                  & \text{ otherwise }
    \end{cases}
$$
\begin{align*}
    \f{EN_{s,e}} & =
    \left(
    M_{s,e} \bigvee
    \left(
    \bigvee_{s'\prec s}EN_{s',e}
    \right)
    \right)
    \bigwedge
    Con(s)
\end{align*}
Where we have:
\begin{align*}
    Con(s)   & =   \left(
    \bigwedge_{ 1\leq j<j' \leq n \wedge e_j,e_{j'} \in s}
    \neg C_{e_j,e_{j'}}
    \right)               \\
    Min(s,e) & = \left(
    \bigwedge_{s' \subseteq E. (s' \subset s \vee s \subset s')
        \wedge e \notin s'}
    \neg M_{s',e}
    \right)
\end{align*}

\noindent Let $S \subseteq E$ be a subset of events.
We define $\varphi_S$, a boolean formula of primitive
events as follows:
\begin{align*}
    \left(
        \bigwedge_{\forall e,e' \in S} \neg C_{e,e'}
    \right)
    \bigwedge
    \left(
        \bigwedge_{\forall e \in S}
        \left(
            \bigvee_{\forall \pi \in \pi_S} 
            \left(
                EN_{\e,\pi_1} \wedge
                EN_{\s{\pi_1},\pi_2} \wedge
                \dots
                \wedge
                EN_{\s{\pi_1,...,\pi_{n_1}},p_n}
            \right)
        \right)
    \right)
\end{align*}
\noindent Where $\pi_S$ is the set of all permutations of $S$.
For a permutation $\pi \in \pi_S$, where $|S| = n$, 
we write $\pi_i$ where $1 \leq i \leq n$ for the $i$th 
element of $\pi$.
Thus, for a given subset of events $S \subseteq E$, 
we can use $\varphi_S$ as the effect for which we look
for a cause.


\pagebreak

